# Onboarding Flow - Visual Guide

## ğŸ¯ The 5-Step Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TAMPA APP ONBOARDING                         â”‚
â”‚              "From Signup to Fully Operational"                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Step 1: REGISTRATION
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ Create Your Account                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ First Name / Last Name                          â”‚
â”‚  â€¢ Email Address                                   â”‚
â”‚  â€¢ Password (with strength meter)                  â”‚
â”‚  â€¢ Terms & Conditions acceptance                   â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Create auth.users record                        â”‚
â”‚  âœ“ Create profiles record                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
Step 2: COMPANY INFO
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¢ Tell Us About Your Business                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ Business Type (7 options with icons)            â”‚
â”‚  â€¢ Business Name                                   â”‚
â”‚  â€¢ ABN / ACN (with validation)                     â”‚
â”‚  â€¢ Full Australian Address                         â”‚
â”‚  â€¢ Phone Number                                    â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Create organizations record                     â”‚
â”‚  âœ“ Link user to organization                       â”‚
â”‚  âœ“ Assign 'owner' role                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
Step 3: PRODUCTS (Optional)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ Add Your Products/Recipes                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  Two import methods:                               â”‚
â”‚  â€¢ Manual Entry (name, category, allergens)        â”‚
â”‚  â€¢ CSV Import (drag & drop with preview)           â”‚
â”‚                                                     â”‚
â”‚  Features:                                         â”‚
â”‚  â€¢ 10 allergen badges                              â”‚
â”‚  â€¢ CSV template download                           â”‚
â”‚  â€¢ Validation & preview                            â”‚
â”‚  â€¢ Skip option                                     â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Bulk insert to recipes table                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
Step 4: TEAM MEMBERS (Optional)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ Add Your Team Members                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ 6 role types (cook, barista, chef, etc.)        â”‚
â”‚  â€¢ Display Name                                    â”‚
â”‚  â€¢ PIN (auto-generate or manual)                   â”‚
â”‚  â€¢ Optional: Email & Phone                         â”‚
â”‚  â€¢ Notes                                           â”‚
â”‚                                                     â”‚
â”‚  Features:                                         â”‚
â”‚  â€¢ PIN auto-generation                             â”‚
â”‚  â€¢ Show/hide PIN toggle                            â”‚
â”‚  â€¢ Duplicate PIN detection                         â”‚
â”‚  â€¢ Skip option                                     â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Hash PINs (SHA-256)                             â”‚
â”‚  âœ“ Bulk insert to team_members table               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
Step 5: INVITE USERS (Optional)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ‰ï¸ Invite Auth Users                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ 3 roles (admin, manager, leader_chef)           â”‚
â”‚  â€¢ Email address                                   â”‚
â”‚  â€¢ Personal message (optional)                     â”‚
â”‚                                                     â”‚
â”‚  Features:                                         â”‚
â”‚  â€¢ Role descriptions                               â”‚
â”‚  â€¢ Duplicate email detection                       â”‚
â”‚  â€¢ Personal message field                          â”‚
â”‚  â€¢ Skip option                                     â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Create user_invitations records                 â”‚
â”‚  âœ“ Generate unique tokens                          â”‚
â”‚  âœ“ Call Edge Function to send emails               â”‚
â”‚                                                     â”‚
â”‚  ğŸ“§ Email Includes:                                â”‚
â”‚  â€¢ Beautiful HTML template                         â”‚
â”‚  â€¢ Personal message from inviter                   â”‚
â”‚  â€¢ Invitation link with token                      â”‚
â”‚  â€¢ 7-day expiration notice                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
COMPLETE! ğŸ‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ¨ You're All Set!                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”‚
â”‚  â€¢ Show success animation                          â”‚
â”‚  â€¢ Display summary of what was created             â”‚
â”‚  â€¢ "Go to Dashboard" button                        â”‚
â”‚                                                     â”‚
â”‚  Database Actions:                                 â”‚
â”‚  âœ“ Mark onboarding_completed = true                â”‚
â”‚  âœ“ Set onboarding_completed_at timestamp           â”‚
â”‚                                                     â”‚
â”‚  â†’ Redirect to /dashboard                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ UI Components Map

```
/src/pages/Onboarding.tsx (Main Container)
    â”‚
    â”œâ”€â”€ OnboardingSteps.tsx (Progress Indicator)
    â”‚   â””â”€â”€ Shows: 1â—â”€2â—â”€3â—â”€4â—â”€5â—‹ with animations
    â”‚
    â”œâ”€â”€ [Conditional Rendering Based on currentStep]
    â”‚
    â”œâ”€â”€ RegistrationStep.tsx
    â”‚   â”œâ”€â”€ Input: firstName
    â”‚   â”œâ”€â”€ Input: lastName
    â”‚   â”œâ”€â”€ Input: email
    â”‚   â”œâ”€â”€ Input: password (with strength meter)
    â”‚   â”œâ”€â”€ Input: confirmPassword (with match indicator)
    â”‚   â””â”€â”€ Checkbox: acceptTerms
    â”‚
    â”œâ”€â”€ CompanyInfoStep.tsx
    â”‚   â”œâ”€â”€ BusinessTypeSelector (7 cards with icons)
    â”‚   â”œâ”€â”€ Input: businessName
    â”‚   â”œâ”€â”€ Input: abn (with tooltip)
    â”‚   â”œâ”€â”€ Input: acn (with tooltip)
    â”‚   â”œâ”€â”€ AddressForm (5 fields)
    â”‚   â”œâ”€â”€ Input: phone
    â”‚   â”œâ”€â”€ Input: website (optional)
    â”‚   â””â”€â”€ Navigation: Back / Next
    â”‚
    â”œâ”€â”€ ProductsStep.tsx
    â”‚   â”œâ”€â”€ Tabs: Manual / CSV
    â”‚   â”œâ”€â”€ [Manual Tab]
    â”‚   â”‚   â”œâ”€â”€ Input: name
    â”‚   â”‚   â”œâ”€â”€ Select: category
    â”‚   â”‚   â”œâ”€â”€ AllergenBadges (10 toggles)
    â”‚   â”‚   â””â”€â”€ Textarea: description
    â”‚   â”œâ”€â”€ [CSV Tab]
    â”‚   â”‚   â”œâ”€â”€ FileDropzone (drag & drop)
    â”‚   â”‚   â”œâ”€â”€ DownloadTemplate button
    â”‚   â”‚   â”œâ”€â”€ PreviewTable
    â”‚   â”‚   â””â”€â”€ ValidationMessages
    â”‚   â””â”€â”€ Navigation: Back / Skip / Next
    â”‚
    â”œâ”€â”€ TeamMembersStep.tsx
    â”‚   â”œâ”€â”€ RoleSelector (6 cards with icons)
    â”‚   â”œâ”€â”€ Input: displayName
    â”‚   â”œâ”€â”€ PINInput (with generate button)
    â”‚   â”œâ”€â”€ Input: email (optional)
    â”‚   â”œâ”€â”€ Input: phone (optional)
    â”‚   â”œâ”€â”€ Textarea: notes (optional)
    â”‚   â”œâ”€â”€ AddedMembersList (cards with remove)
    â”‚   â””â”€â”€ Navigation: Back / Skip / Next
    â”‚
    â”œâ”€â”€ InviteUsersStep.tsx
    â”‚   â”œâ”€â”€ RoleSelector (3 cards with descriptions)
    â”‚   â”œâ”€â”€ Input: email
    â”‚   â”œâ”€â”€ Textarea: personalMessage (optional)
    â”‚   â”œâ”€â”€ InvitationsList (preview cards)
    â”‚   â””â”€â”€ Navigation: Back / Skip / Next
    â”‚
    â””â”€â”€ CompleteScreen (currentStep === 'complete')
        â”œâ”€â”€ Emoji: ğŸ‰
        â”œâ”€â”€ Heading: "You're All Set!"
        â”œâ”€â”€ Summary text
        â””â”€â”€ Button: "Go to Dashboard"
```

---

## ğŸ—„ï¸ Database Entity Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  auth.users   â”‚ (Supabase Auth)
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚ 1
        â”‚ creates
        â†“ N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      1       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   profiles    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ organizations   â”‚
â”‚               â”‚   belongs_to  â”‚                 â”‚
â”‚ â€¢ display_nameâ”‚               â”‚ â€¢ business_type â”‚
â”‚ â€¢ email       â”‚               â”‚ â€¢ abn / acn     â”‚
â”‚ â€¢ onboarding_ â”‚               â”‚ â€¢ address_*     â”‚
â”‚   completed   â”‚               â”‚ â€¢ owner_id      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                                 â”‚
        â”‚ N                              Nâ”‚
        â”‚                                 â”‚
        â†“                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  user_roles   â”‚               â”‚  team_members   â”‚
â”‚               â”‚               â”‚                 â”‚
â”‚ â€¢ role        â”‚               â”‚ â€¢ display_name  â”‚
â”‚ â€¢ user_id     â”‚               â”‚ â€¢ pin_hash      â”‚
â”‚ â€¢ org_id      â”‚               â”‚ â€¢ role          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

        â”‚ N
        â”‚
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ user_invitations   â”‚
â”‚                    â”‚
â”‚ â€¢ email            â”‚
â”‚ â€¢ role             â”‚
â”‚ â€¢ token            â”‚
â”‚ â€¢ status           â”‚
â”‚ â€¢ expires_at       â”‚
â”‚ â€¢ invited_by       â”‚
â”‚ â€¢ organization_id  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    recipes      â”‚ (products)
â”‚                 â”‚
â”‚ â€¢ name          â”‚
â”‚ â€¢ category      â”‚
â”‚ â€¢ allergens     â”‚
â”‚ â€¢ created_by    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Data Flow During Onboarding

```
USER ACTIONS                  REACT STATE              DATABASE OPERATIONS

[Fill Registration]
  email: test@example.com
  password: â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢
         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  registrationData: {...}
                              â”‚
                              â”‚ (on Step 5 submit)
                              â†“
[All Steps Complete]    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         â”‚              completeOnboarding()
         â”‚                     â”‚
         â†“                     â”œâ†’ registerUser()
                               â”‚     â†“
[Submit Button]                â”‚  CREATE auth.users
         â”‚                     â”‚  CREATE profiles
         â”‚                     â”‚
         â”‚                     â”œâ†’ createOrganization()
         â†“                     â”‚     â†“
                               â”‚  CREATE organizations
[Loading Spinner]              â”‚  UPDATE profiles.org_id
         â”‚                     â”‚  CREATE user_roles
         â”‚                     â”‚
         â”‚                     â”œâ†’ importProducts()
         â†“                     â”‚     â†“
                               â”‚  BULK INSERT recipes
[Success Toast]                â”‚
         â”‚                     â”œâ†’ createTeamMembers()
         â”‚                     â”‚     â†“
         â†“                     â”‚  HASH PINs (SHA-256)
                               â”‚  BULK INSERT team_members
[Redirect to Dashboard]        â”‚
                               â”œâ†’ sendUserInvitations()
                               â”‚     â†“
                               â”‚  CREATE user_invitations
                               â”‚  CALL Edge Function
                               â”‚  SEND Emails
                               â”‚
                               â””â†’ Mark Complete
                                     â†“
                                  UPDATE profiles
                                  SET onboarding_completed = true
```

---

## ğŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CLIENT SIDE (Browser)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Input validation (regex, length, format)     â”‚
â”‚  â€¢ Password strength checking                   â”‚
â”‚  â€¢ Duplicate detection (client state)           â”‚
â”‚  â€¢ ABN/ACN checksum validation                  â”‚
â”‚  â€¢ PIN hashing (SHA-256) before send            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ HTTPS
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUPABASE CLIENT LIBRARY                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ JWT token management                         â”‚
â”‚  â€¢ Automatic token refresh                      â”‚
â”‚  â€¢ Request authentication                       â”‚
â”‚  â€¢ Session persistence                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ Authenticated Requests
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EDGE FUNCTIONS (Deno Runtime)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Token verification                           â”‚
â”‚  â€¢ Service role operations (admin API)          â”‚
â”‚  â€¢ Email sending                                â”‚
â”‚  â€¢ Rate limiting (TODO)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SUPABASE API LAYER                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Auth verification                            â”‚
â”‚  â€¢ RLS policy enforcement                       â”‚
â”‚  â€¢ Connection pooling                           â”‚
â”‚  â€¢ Query optimization                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  POSTGRESQL DATABASE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Row-Level Security (RLS) policies            â”‚
â”‚  â€¢ Foreign key constraints                      â”‚
â”‚  â€¢ Check constraints                            â”‚
â”‚  â€¢ NOT NULL constraints                         â”‚
â”‚  â€¢ Unique constraints                           â”‚
â”‚  â€¢ Indexed columns                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“§ Email Invitation Flow

```
[User invites admin@example.com]
          â†“
[Create invitation record in DB]
    â€¢ token: abc123...xyz789 (32 bytes, hex)
    â€¢ expires_at: now() + 7 days
    â€¢ status: 'pending'
          â†“
[Call Edge Function: send-invitation]
          â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Edge Function (Deno)       â”‚
    â”‚  â€¢ Verify JWT token         â”‚
    â”‚  â€¢ Get invitation data      â”‚
    â”‚  â€¢ Build email HTML         â”‚
    â”‚  â€¢ Call Supabase Admin API  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Supabase Auth Admin        â”‚
    â”‚  â€¢ Create auth invitation   â”‚
    â”‚  â€¢ Queue email for sending  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Email Service              â”‚
    â”‚  â€¢ Render HTML template     â”‚
    â”‚  â€¢ Add invitation link      â”‚
    â”‚  â€¢ Send via SMTP            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
[Recipient receives beautiful HTML email]
          â†“
[Click "Accept Invitation" button]
          â†“
[Redirected to /accept-invitation?token=abc123...]
          â†“
[TODO: Acceptance flow not yet built]
    â€¢ Verify token
    â€¢ Check expiration
    â€¢ Set password
    â€¢ Assign role
    â€¢ Mark accepted
```

---

## ğŸ¯ Feature Toggle States

```
Products Step
  â”œâ”€ If importMethod === 'manual':
  â”‚    Show manual entry form
  â”‚
  â””â”€ If importMethod === 'csv':
       Show CSV upload UI

Team Members Step
  â”œâ”€ If skipForNow === true:
  â”‚    Skip database operations
  â”‚
  â””â”€ If skipForNow === false:
       Create team_members records

Invite Users Step
  â”œâ”€ If skipForNow === true:
  â”‚    Skip invitations
  â”‚
  â””â”€ If skipForNow === false:
       Send email invitations

PIN Input
  â”œâ”€ If showPin === true:
  â”‚    Display PIN as text
  â”‚
  â””â”€ If showPin === false:
       Display PIN as â€¢â€¢â€¢â€¢â€¢â€¢

Password Input
  â”œâ”€ If showPassword === true:
  â”‚    Display password as text
  â”‚
  â””â”€ If showPassword === false:
       Display password as â€¢â€¢â€¢â€¢â€¢â€¢
```

---

## ğŸš¦ Loading & Error States

```
Initial State
    â†“
[User fills form]
    â†“
[User clicks Submit]
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ loading = true      â”‚
â”‚ Show spinner        â”‚
â”‚ Disable form        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â†“
   Database Operations
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚           â”‚
SUCCESS        ERROR
    â”‚           â”‚
    â†“           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show  â”‚  â”‚ error = msg  â”‚
â”‚ Toast â”‚  â”‚ Show alert   â”‚
â”‚       â”‚  â”‚ Enable form  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“
[Redirect]
```

---

## ğŸ“± Responsive Breakpoints

```
Mobile (< 640px)
â”œâ”€ Single column layout
â”œâ”€ Full-width cards
â”œâ”€ Stacked form fields
â””â”€ Touch-friendly buttons (min 44px)

Tablet (640px - 1024px)
â”œâ”€ Two-column layout where appropriate
â”œâ”€ Larger form spacing
â””â”€ Side-by-side buttons

Desktop (> 1024px)
â”œâ”€ Max width: 4xl (896px)
â”œâ”€ Centered layout
â”œâ”€ Optimal reading width
â””â”€ Hover states on all interactive elements
```

---

## ğŸ¨ Theme Colors

```
Primary Gradient
  from: #667eea (Indigo)
  to:   #764ba2 (Purple)

Background
  Light: #ffffff
  Dark:  #0f172a

Muted
  Light: #f1f5f9
  Dark:  #1e293b

Destructive
  #ef4444 (Red)

Success
  #10b981 (Green)

Borders
  #e2e8f0
```

---

This visual guide shows the complete architecture, data flow, and user journey through the onboarding system!
